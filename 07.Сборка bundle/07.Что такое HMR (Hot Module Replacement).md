# üìå –ß—Ç–æ —Ç–∞–∫–æ–µ HMR (Hot Module Replacement)?

**Hot Module Replacement (HMR)** ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –∑–∞–º–µ–Ω—è—Ç—å –º–æ–¥—É–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –±–µ–∑ –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –û–Ω —Ç–µ—Å–Ω–æ —Å–≤—è–∑–∞–Ω —Å –±–∞–Ω–¥–ª–∏–Ω–≥–æ–º: –±–∞–Ω–¥–ª–µ—Ä (—á–∞—â–µ Webpack) –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤, –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏ –∏ ¬´–≥–æ—Ä—è—á–æ¬ª –ø–æ–¥–º–µ–Ω—è–µ—Ç –∏—Ö –≤ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–º –±–∞–Ω–¥–ª–µ.

---

## üìå –ó–∞—á–µ–º –Ω—É–∂–µ–Ω HMR?

- **‚ö° –ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å**: –º–µ–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –º–µ–∂–¥—É –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –∫–æ–¥–∞ –∏ –µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –≤ –±—Ä–∞—É–∑–µ—Ä–µ.
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è**: —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, Redux store) –æ—Å—Ç–∞–µ—Ç—Å—è –º–µ–∂–¥—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏.
- **–ë–µ–∑ –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏**: –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–π –º–æ–¥—É–ª—å.
- **–û—Ç–ª–∏—á–Ω–æ –¥–ª—è CSS**: –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∏–ª–µ–π –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.

---

## üìå –ö–∞–∫ HMR —Å–≤—è–∑–∞–Ω —Å –±–∞–Ω–¥–ª–∏–Ω–≥–æ–º?

HMR –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –ø—Ä–æ—Ü–µ—Å—Å –±–∞–Ω–¥–ª–∏–Ω–≥–∞:
1. –ë–∞–Ω–¥–ª–µ—Ä –Ω–∞—Ö–æ–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∏—Å—Ö–æ–¥–Ω–∏–∫–∞—Ö.
2. –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏ (–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞).
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –±—Ä–∞—É–∑–µ—Ä –ø–æ WebSocket.
4. –ü—Ä–∏–º–µ–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è, –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü—É.

> –í —Å–≤—è–∑–∫–µ —Å Webpack —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ DevServer –∏ HMR Runtime, –∫–æ—Ç–æ—Ä—ã–π ¬´–ø–æ–¥—à–∏–≤–∞–µ—Ç¬ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π –±–∞–Ω–¥–ª.

---

## üìå –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —à–∞–≥–∞–º

1. **DevServer** ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å HMR.
2. **WebSocket** ‚Äî –±—Ä–∞—É–∑–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º.
3. **Diff-—Å–±–æ—Ä–∫–∞** ‚Äî –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–∏–≤—à–∏–π—Å—è –º–æ–¥—É–ª—å.
4. **HMR Runtime** ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≥–æ—Ä—è—á—É—é –∑–∞–º–µ–Ω—É.

---

## üìå –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HMR –≤ Webpack

### üîπ –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
npm i -D webpack webpack-cli webpack-dev-server html-webpack-plugin
```

### üîπ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `webpack.dev.js`
```javascript
const path = require('path');
const HtmlWebpackPlugin = require('html-webpack-plugin');

module.exports = {
    mode: 'development',
    entry: './src/index.js',
    output: {
        filename: 'bundle.js',
        path: path.resolve(__dirname, 'dist'),
    },
    devServer: {
        static: './dist',
        hot: true, // –í–∫–ª—é—á–µ–Ω–∏–µ HMR
        open: true,
        port: 3000,
    },
    plugins: [
        new HtmlWebpackPlugin({ template: './src/index.html' }),
    ],
    module: {
        rules: [
            {
                test: /\.css$/,
                use: ['style-loader', 'css-loader'], // –ê–≤—Ç–æ-HMR –¥–ª—è CSS
            },
        ],
    },
};
```

### üîπ –í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª (`src/index.js`)
```javascript
import './styles.css';
import { renderApp } from './app';

renderApp();

if (module && module.hot) {
    module.hot.accept('./app', () => {
        // –¢–æ—á–∫–∞ –≥–æ—Ä—è—á–µ–π –∑–∞–º–µ–Ω—ã
        document.body.innerHTML = '';
        renderApp();
    });
}
```

### üîπ –ü—Ä–∏–º–µ—Ä –º–æ–¥—É–ª—è (`src/app.js`)
```javascript
export function renderApp() {
    const el = document.createElement('div');
    el.textContent = 'Hello HMR!';
    document.body.appendChild(el);
}
```

### üîπ –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
```json
{
  "scripts": {
    "start": "webpack serve --config webpack.dev.js"
  }
}
```

---

## üìå –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- **–¢–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**: –≤ production HMR –æ—Ç–∫–ª—é—á—ë–Ω.
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫**: –Ω–µ –≤—Å–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏–∑ –∫–æ—Ä–æ–±–∫–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç HMR API.
- **–°–æ—Å—Ç–æ—è–Ω–∏–µ**: –±–µ–∑ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –º–æ–∂–Ω–æ –ø–æ—Ç–µ—Ä—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –∑–∞–º–µ–Ω–µ –º–æ–¥—É–ª–µ–π.
- **CSS**: —Å `style-loader` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –±–µ–∑ —Ä—É—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏; –¥–ª—è JS —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `module.hot.accept`.

---

## üìå –ü—Ä–∏–º–µ—Ä: HMR –¥–ª—è CSS

```javascript
// index.js
import './styles.css'; // –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ style-loader
```

```css
/* styles.css */
body { font-family: system-ui, sans-serif; }
button { padding: 8px 12px; }
```

–ò–∑–º–µ–Ω–∏—Ç–µ CSS ‚Äî –±—Ä–∞—É–∑–µ—Ä –æ–±–Ω–æ–≤–∏—Ç —Å—Ç–∏–ª–∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.

---

## üéØ –ò—Ç–æ–≥

**HMR** ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–æ–≤–µ—Ä—Ö –±–∞–Ω–¥–ª–∏–Ω–≥–∞, —É—Å–∫–æ—Ä—è—é—â–∏–π —Ü–∏–∫–ª ¬´–∏–∑–º–µ–Ω–∏–ª ‚Äî —É–≤–∏–¥–µ–ª¬ª. –û–Ω –ø–æ–¥–º–µ–Ω—è–µ—Ç –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏ –≤ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–º –±–∞–Ω–¥–ª–µ –ø–æ WebSocket, —Å–æ—Ö—Ä–∞–Ω—è—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ —ç–∫–æ–Ω–æ–º—è –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

## üèÜ –ó–ê–î–ê–ß–ò

–ó–∞–¥–∞—á–∏, —á—Ç–æ–±—ã –∑–∞–∫—Ä–µ–ø–∏—Ç—å `HMR` –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ:

---

### üìå –ó–∞–¥–∞—á–∞ 1: –í–∫–ª—é—á–∏—Ç—å HMR –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–∞

–†–µ–∞–ª–∏–∑—É–π—Ç–µ –ø—Ä–æ—Å—Ç–æ–π —Å—á—ë—Ç—á–∏–∫ –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ HMR —Ç–∞–∫, —á—Ç–æ–±—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞ –∫–Ω–æ–ø–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–ª–æ—Å—å.

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫.
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∫–Ω–æ–ø–∫–∏ –≤ `app.js` –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–∞.

<details>
<summary>‚úç –†–µ—à–µ–Ω–∏–µ</summary>

```javascript
// src/app.js
export function mount(root, state) {
    root.innerHTML = '';
    const button = document.createElement('button');
    button.textContent = `Count: ${state.count}`; // –º–µ–Ω—è–π—Ç–µ —Ç–µ–∫—Å—Ç –≤ —Ö–æ–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
    button.addEventListener('click', () => {
        state.count += 1;
        button.textContent = `Count: ${state.count}`;
    });
    root.appendChild(button);
}

// src/index.js
import { mount } from './app';

const appRoot = document.createElement('div');
document.body.appendChild(appRoot);

// —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–Ω–µ –º–æ–¥—É–ª—è app ‚Äî –ø–µ—Ä–µ–∂–∏–≤–∞–µ—Ç –∑–∞–º–µ–Ω—É
const appState = { count: 0 };

mount(appRoot, appState);

if (module && module.hot) {
    module.hot.accept('./app', () => {
        // –ø–æ–≤—Ç–æ—Ä–Ω–æ –º–æ–Ω—Ç–∏—Ä—É–µ–º, —Å–æ—Ö—Ä–∞–Ω—è—è appState
        const next = require('./app');
        next.mount(appRoot, appState);
    });
}
```
</details>

---

### üìå –ó–∞–¥–∞—á–∞ 2: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å HMR –¥–ª—è CSS –∏ JS –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

–°–æ–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é, –≤ –∫–æ—Ç–æ—Ä–æ–π:
- CSS –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.
- JS-–º–æ–¥—É–ª—å –∑–∞–º–µ–Ω—è–µ—Ç—Å—è ¬´–≥–æ—Ä—è—á–æ¬ª —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º —Ä–µ–Ω–¥–µ—Ä–æ–º —É–∑–ª–∞.

<details>
<summary>‚úç –†–µ—à–µ–Ω–∏–µ</summary>

```javascript
// webpack.dev.js
const path = require('path');
const HtmlWebpackPlugin = require('html-webpack-plugin');

module.exports = {
  mode: 'development',
  entry: './src/index.js',
  output: { filename: 'bundle.js', path: path.resolve(__dirname, 'dist') },
  devServer: { static: './dist', hot: true, open: true },
  plugins: [new HtmlWebpackPlugin({ template: './src/index.html' })],
  module: {
    rules: [
      { test: /\.css$/, use: ['style-loader', 'css-loader'] },
      { test: /\.js$/, exclude: /node_modules/, use: 'babel-loader' }
    ]
  }
};
```

```javascript
// src/index.js
import './styles.css';
import { render } from './widget';

const root = document.querySelector('#root');
render(root);

if (module && module.hot) {
  module.hot.accept('./widget', () => {
    const next = require('./widget');
    next.render(root);
  });
}
```

```javascript
// src/widget.js
export function render(root) {
  root.innerHTML = `<h1>Widget v1</h1>`; // –º–µ–Ω—è–π—Ç–µ —Ç–µ–∫—Å—Ç –∏ –Ω–∞–±–ª—é–¥–∞–π—Ç–µ HMR
}
```
</details>

---

üéâ –≠—Ç–∏ –∑–∞–¥–∞—á–∏ –ø–æ–º–æ–≥—É—Ç –æ—Ç—Ä–∞–±–æ—Ç–∞—Ç—å HMR –¥–ª—è JS –∏ CSS, –∞ —Ç–∞–∫–∂–µ –Ω–∞—É—á–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É ¬´–≥–æ—Ä—è—á–∏–º–∏¬ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏.

---