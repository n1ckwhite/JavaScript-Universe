# üìå –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤ Node.js

**–û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ Node.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö** —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞, –≤–∫–ª—é—á–∞—é—â–µ–≥–æ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏. –í–æ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã:

---

## üîπ 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

### üìå –ê—É–¥–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –∫–æ–º–∞–Ω–¥—É** `npm audit` –∏–ª–∏ `yarn audit` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö
- **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
- **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–æ–ª—å–∫–æ —Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã

### üìå –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è —á–∏—Å–ª–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **–ò–∑–±–µ–≥–∞–π—Ç–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö –∏–ª–∏ –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫**
- **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫** –ø–µ—Ä–µ–¥ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º

---

## üîπ 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### üìå –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤
- **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** (–∫–ª—é—á–∏ API, –ø–∞—Ä–æ–ª–∏) –≤ –∫–æ–¥–µ
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** —á–µ—Ä–µ–∑ –ø–∞–∫–µ—Ç—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ `dotenv`
- **–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–∞–º–∏**, —Ç–∞–∫–∏–µ –∫–∞–∫ HashiCorp Vault, AWS Secrets Manager –∏–ª–∏ Azure Key Vault

### üìå –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏–π
- **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–æ–¥–∞–∫—à–Ω–∞

---

## üîπ 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞

### üìå –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏**, —Ç–∞–∫–∏–µ –∫–∞–∫ `Joi` –∏–ª–∏ `Validator.js`, –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞
- **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å–µ—Ä–≤–µ—Ä–∞

### üìå –ò–∑–±–µ–≥–∞–π—Ç–µ NoSQL-–∏–Ω—ä–µ–∫—Ü–∏–π
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏**, —Ç–∞–∫–∏–µ –∫–∞–∫ `mongoose`, —Å –≤–∫–ª—é—á—ë–Ω–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Å—Ö–µ–º—ã
- **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—Å—Ç–∞–≤–ª—è–π—Ç–µ –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –≤ –∑–∞–ø—Ä–æ—Å—ã

---

## üîπ 4. –ó–∞—â–∏—Ç–∞ –æ—Ç –æ–±—â–∏—Ö –∞—Ç–∞–∫

### üìå SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ORM**, —Ç–∞–∫–∏–µ –∫–∞–∫ Sequelize –∏–ª–∏ TypeORM, –∏–ª–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è

### üìå XSS (–º–µ–∂—Å–∞–π—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç–∏–Ω–≥)
- **–≠–∫—Ä–∞–Ω–∏—Ä—É–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥** –≤ HTML-–≤—ã–≤–æ–¥–µ
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏**, —Ç–∞–∫–∏–µ –∫–∞–∫ `xss-clean`

### üìå CSRF (–ø–æ–¥–¥–µ–ª–∫–∞ –º–µ–∂—Å–∞–π—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)
- **–í–∫–ª—é—á–∏—Ç–µ CSRF-–∑–∞—â–∏—Ç—É** —á–µ—Ä–µ–∑ middleware, –Ω–∞–ø—Ä–∏–º–µ—Ä, `csurf`

### üìå –ó–∞—â–∏—Ç–∞ –æ—Ç DoS-–∞—Ç–∞–∫
- **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ —Ä–∞–∑–º–µ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤** —Å –ø–æ–º–æ—â—å—é middleware, —Ç–∞–∫–æ–≥–æ –∫–∞–∫ `express.json({ limit: '10kb' })`
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**, —Ç–∞–∫–∏–µ –∫–∞–∫ `express-rate-limit`, –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–∏—Å–ª–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –æ–¥–Ω–æ–≥–æ IP
- **–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CDN** –∏–ª–∏ WAF (Web Application Firewall)

---

## üîπ 5. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–µ—Ç–µ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è

### üìå HTTPS
- **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS** –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö
- **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ HSTS** (HTTP Strict Transport Security)

### üìå –ó–∞—â–∏—Ç–∞ CORS
- **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ cors middleware** –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ —Ç–æ–ª—å–∫–æ —Å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

### üìå Firewall –∏ –ø—Ä–æ–∫—Å–∏
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä—ã –∏ –æ–±—Ä–∞—Ç–Ω—ã–µ –ø—Ä–æ–∫—Å–∏**, —Ç–∞–∫–∏–µ –∫–∞–∫ NGINX, –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞

---

## üîπ 6. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Å—Å–∏–π –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### üìå JWT (JSON Web Tokens)
- **–ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ —Ç–æ–∫–µ–Ω—ã** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏–ª–∏ –∫–ª—é—á–µ–π RSA
- **–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–æ–≤**
- **–•—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö HTTP-only cookies**

### üìå –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ bcrypt –∏–ª–∏ argon2** –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
- **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ø–∞—Ä–æ–ª–∏** –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ

---

## üîπ 7. –ó–∞—â–∏—Ç–∞ –∫–æ–¥–∞

### üìå –õ–∏–Ω—Ç–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–∏–Ω—Ç–µ—Ä—ã**, —Ç–∞–∫–∏–µ –∫–∞–∫ `eslint-plugin-security`

### üìå –ü—Ä–∏–Ω—Ü–∏–ø—ã –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π
- **–ó–∞–ø—É—Å–∫–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
- **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø** –∫ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º —Ñ–∞–π–ª–∞–º

---

## üîπ 8. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞—É–¥–∏—Ç

### üìå –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**, —Ç–∞–∫–∏–µ –∫–∞–∫ New Relic –∏–ª–∏ Datadog, –¥–ª—è –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ –∞–Ω–æ–º–∞–ª–∏—è–º–∏

### üìå –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–õ–æ–≥–∏—Ä—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –±–µ–∑–æ–ø–∞—Å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é**, –∏–∑–±–µ–≥–∞–π—Ç–µ –∑–∞–ø–∏—Å–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**, —Ç–∞–∫–∏–µ –∫–∞–∫ Winston –∏–ª–∏ Morgan

### üìå –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–æ–¥–∏—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫–∞–Ω–µ—Ä—ã**, —Ç–∞–∫–∏–µ –∫–∞–∫ OWASP ZAP –∏–ª–∏ Burp Suite

---

## üîπ 9. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –ø–∞—Ç—á–∏

- **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ Node.js** –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- **–°–ª–µ–¥–∏—Ç–µ –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏** –≤ Node.js Security Releases

---

## üîπ 10. –û–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã

- **–ü—Ä–æ–≤–æ–¥–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- **–û–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞–º–∏**, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ OWASP Top Ten

---

## üîπ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### üìå Middleware –¥–ª—è Express.js
```javascript
const helmet = require('helmet');
const rateLimit = require('express-rate-limit');
const cors = require('cors');

// –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
app.use(helmet());

// –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
const limiter = rateLimit({
    windowMs: 15 * 60 * 1000, // 15 –º–∏–Ω—É—Ç
    max: 100 // –º–∞–∫—Å–∏–º—É–º 100 –∑–∞–ø—Ä–æ—Å–æ–≤ —Å IP
});
app.use(limiter);

// CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
app.use(cors({
    origin: process.env.ALLOWED_ORIGINS?.split(',') || ['http://localhost:3000'],
    credentials: true
}));
```

### üìå –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
```javascript
const Joi = require('joi');

const userSchema = Joi.object({
    email: Joi.string().email().required(),
    password: Joi.string().min(8).pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/).required(),
    age: Joi.number().integer().min(18).max(120)
});

// Middleware –≤–∞–ª–∏–¥–∞—Ü–∏–∏
const validateUser = (req, res, next) => {
    const { error } = userSchema.validate(req.body);
    if (error) {
        return res.status(400).json({ error: error.details[0].message });
    }
    next();
};
```

### üìå –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
```javascript
const bcrypt = require('bcrypt');

// –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è
const hashPassword = async (password) => {
    const saltRounds = 12;
    return await bcrypt.hash(password, saltRounds);
};

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è
const verifyPassword = async (password, hash) => {
    return await bcrypt.compare(password, hash);
};
```

---

## üéØ –ò—Ç–æ–≥

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Node.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π** ‚Äî —ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, —Ç—Ä–µ–±—É—é—â–∏–π –≤–Ω–∏–º–∞–Ω–∏—è –∫ –º–Ω–æ–∂–µ—Å—Ç–≤—É –∞—Å–ø–µ–∫—Ç–æ–≤. –ü—Ä–∏–º–µ–Ω—è—è —ç—Ç–∏ –º–µ—Ä—ã, –≤—ã —Å–º–æ–∂–µ—Ç–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—Å–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–∞—à–µ–≥–æ Node.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
- –í—Å–µ–≥–¥–∞ –≤–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏ –ª–æ–≥–∏—Ä—É–π—Ç–µ —Å–æ–±—ã—Ç–∏—è
- –°–ª–µ–¥—É–π—Ç–µ –ø—Ä–∏–Ω—Ü–∏–ø—É –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π

## üèÜ –ó–ê–î–ê–ß–ò

–í–æ—Ç –Ω–∞–±–æ—Ä –∑–∞–¥–∞—á, —á—Ç–æ–±—ã –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å `–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤ Node.js`:

---

### üìå –ó–∞–¥–∞—á–∞ 1: –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

‚ùì –°–æ–∑–¥–∞–π—Ç–µ middleware –¥–ª—è Express.js, –∫–æ—Ç–æ—Ä–æ–µ:
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é Joi
- –°–∞–Ω–∏—Ç–∏–∑–∏—Ä—É–µ—Ç HTML-–∫–æ–Ω—Ç–µ–Ω—Ç –æ—Ç XSS-–∞—Ç–∞–∫
- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤
- –õ–æ–≥–∏—Ä—É–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

```javascript
// –°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏:
// createValidationMiddleware(schema) - —Å–æ–∑–¥–∞–µ—Ç middleware –≤–∞–ª–∏–¥–∞—Ü–∏–∏
// sanitizeInput(input) - –æ—á–∏—â–∞–µ—Ç HTML –æ—Ç –æ–ø–∞—Å–Ω—ã—Ö —Ç–µ–≥–æ–≤
// createSecurityMiddleware() - –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –∑–∞—â–∏—Ç—ã

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
// app.use(createSecurityMiddleware());
// app.post('/users', createValidationMiddleware(userSchema), createUser);
```

<details>
<summary>‚úç –†–µ—à–µ–Ω–∏–µ</summary>

```javascript
const Joi = require('joi');
const xss = require('xss');
const rateLimit = require('express-rate-limit');

class SecurityMiddleware {
    constructor() {
        this.suspiciousActivity = new Map();
        this.maxSuspiciousAttempts = 5;
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ middleware –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    createValidationMiddleware(schema) {
        return (req, res, next) => {
            const { error, value } = schema.validate(req.body, {
                abortEarly: false,
                stripUnknown: true
            });

            if (error) {
                this.logSuspiciousActivity(req.ip, 'validation_error', error.details);
                return res.status(400).json({
                    success: false,
                    message: '–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö',
                    errors: error.details.map(detail => ({
                        field: detail.path.join('.'),
                        message: detail.message
                    }))
                });
            }

            // –°–∞–Ω–∏—Ç–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
            req.body = this.sanitizeObject(value);
            next();
        };
    }

    // –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è HTML-–∫–æ–Ω—Ç–µ–Ω—Ç–∞
    sanitizeInput(input) {
        if (typeof input === 'string') {
            return xss(input, {
                whiteList: {
                    p: [],
                    br: [],
                    strong: [],
                    em: []
                },
                stripIgnoreTag: true,
                stripIgnoreTagBody: ['script']
            });
        }
        return input;
    }

    // –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–∞
    sanitizeObject(obj) {
        if (Array.isArray(obj)) {
            return obj.map(item => this.sanitizeObject(item));
        }
        
        if (obj && typeof obj === 'object') {
            const sanitized = {};
            for (const [key, value] of Object.entries(obj)) {
                sanitized[key] = this.sanitizeObject(value);
            }
            return sanitized;
        }
        
        return this.sanitizeInput(obj);
    }

    // Middleware –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞
    createSizeLimitMiddleware(maxSize = '10mb') {
        return (req, res, next) => {
            const contentLength = parseInt(req.headers['content-length'] || '0');
            const maxBytes = this.parseSize(maxSize);
            
            if (contentLength > maxBytes) {
                this.logSuspiciousActivity(req.ip, 'oversized_request', { size: contentLength });
                return res.status(413).json({
                    success: false,
                    message: '–†–∞–∑–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –¥–æ–ø—É—Å—Ç–∏–º—ã–π –ª–∏–º–∏—Ç'
                });
            }
            
            next();
        };
    }

    // –ü–∞—Ä—Å–∏–Ω–≥ —Ä–∞–∑–º–µ—Ä–∞ –≤ –±–∞–π—Ç—ã
    parseSize(size) {
        const units = { b: 1, kb: 1024, mb: 1024 * 1024, gb: 1024 * 1024 * 1024 };
        const match = size.toLowerCase().match(/^(\d+(?:\.\d+)?)\s*(b|kb|mb|gb)?$/);
        
        if (!match) return 10 * 1024 * 1024; // 10MB –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        
        const value = parseFloat(match[1]);
        const unit = match[2] || 'b';
        
        return Math.floor(value * units[unit]);
    }

    // Rate limiting —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º–∏ –ª–∏–º–∏—Ç–∞–º–∏
    createRateLimitMiddleware() {
        return rateLimit({
            windowMs: 15 * 60 * 1000, // 15 –º–∏–Ω—É—Ç
            max: (req) => {
                // –°–Ω–∏–∂–∞–µ–º –ª–∏–º–∏—Ç –¥–ª—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP
                const attempts = this.suspiciousActivity.get(req.ip) || 0;
                return Math.max(10, 100 - attempts * 10);
            },
            message: {
                success: false,
                message: '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ'
            },
            standardHeaders: true,
            legacyHeaders: false,
            handler: (req, res) => {
                this.logSuspiciousActivity(req.ip, 'rate_limit_exceeded');
                res.status(429).json({
                    success: false,
                    message: '–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤'
                });
            }
        });
    }

    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    logSuspiciousActivity(ip, type, details = {}) {
        const now = Date.now();
        const activity = this.suspiciousActivity.get(ip) || { count: 0, lastSeen: 0, types: [] };
        
        activity.count++;
        activity.lastSeen = now;
        activity.types.push({ type, timestamp: now, details });
        
        // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ (—Å—Ç–∞—Ä—à–µ 1 —á–∞—Å–∞)
        activity.types = activity.types.filter(item => now - item.timestamp < 3600000);
        
        this.suspiciousActivity.set(ip, activity);
        
        console.warn(`üö® –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ—Ç ${ip}: ${type}`, details);
        
        // –ë–ª–æ–∫–∏—Ä—É–µ–º IP –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞
        if (activity.count > this.maxSuspiciousAttempts) {
            console.error(`üö´ IP ${ip} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∏–∑-–∑–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏`);
        }
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ middleware –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
    createSecurityMiddleware(options = {}) {
        const {
            maxRequestSize = '10mb',
            enableRateLimit = true,
            enableValidation = true
        } = options;

        return (req, res, next) => {
            // –õ–æ–≥–∏—Ä—É–µ–º –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã
            console.log(`${new Date().toISOString()} - ${req.method} ${req.url} - ${req.ip}`);
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞
            this.createSizeLimitMiddleware(maxRequestSize)(req, res, (err) => {
                if (err) return next(err);
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º rate limiting
                if (enableRateLimit) {
                    this.createRateLimitMiddleware()(req, res, next);
                } else {
                    next();
                }
            });
        };
    }

    // –°—Ö–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
    static getValidationSchemas() {
        return {
            user: Joi.object({
                email: Joi.string().email().required(),
                password: Joi.string().min(8).pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/).required(),
                name: Joi.string().min(2).max(50).required(),
                age: Joi.number().integer().min(18).max(120)
            }),
            
            post: Joi.object({
                title: Joi.string().min(5).max(200).required(),
                content: Joi.string().min(10).max(5000).required(),
                tags: Joi.array().items(Joi.string().max(20)).max(10)
            }),
            
            comment: Joi.object({
                content: Joi.string().min(1).max(1000).required(),
                postId: Joi.string().required()
            })
        };
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
    getSecurityStats() {
        const stats = {
            totalSuspiciousIPs: this.suspiciousActivity.size,
            blockedIPs: 0,
            totalAttempts: 0
        };

        for (const [ip, activity] of this.suspiciousActivity) {
            stats.totalAttempts += activity.count;
            if (activity.count > this.maxSuspiciousAttempts) {
                stats.blockedIPs++;
            }
        }

        return stats;
    }
}

// –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
const security = new SecurityMiddleware();

// –°–æ–∑–¥–∞–µ–º Express –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
const express = require('express');
const app = express();

app.use(express.json({ limit: '10mb' }));
app.use(security.createSecurityMiddleware());

// –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
app.post('/users', 
    security.createValidationMiddleware(SecurityMiddleware.getValidationSchemas().user),
    (req, res) => {
        res.json({ success: true, message: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω', data: req.body });
    }
);

app.post('/posts',
    security.createValidationMiddleware(SecurityMiddleware.getValidationSchemas().post),
    (req, res) => {
        res.json({ success: true, message: '–ü–æ—Å—Ç —Å–æ–∑–¥–∞–Ω', data: req.body });
    }
);

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
app.get('/security/stats', (req, res) => {
    res.json(security.getSecurityStats());
});

module.exports = SecurityMiddleware;
```

</details>

---

### üìå –ó–∞–¥–∞—á–∞ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å JWT

‚ùì –°–æ–∑–¥–∞–π—Ç–µ —Å–∏—Å—Ç–µ–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å:
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ª–æ–≥–∏–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- JWT —Ç–æ–∫–µ–Ω–∞–º–∏ —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
- –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø–∞—Ä–æ–ª–µ–π —Å bcrypt
- Middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–æ–≤
- –ó–∞—â–∏—Ç–æ–π –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å-–∞—Ç–∞–∫

```javascript
// –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å AuthSystem:
// register(userData) - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
// login(email, password) - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
// verifyToken(token) - –ø—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞
// createAuthMiddleware() - middleware –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
// const auth = new AuthSystem();
// app.post('/register', auth.register);
// app.post('/login', auth.login);
// app.get('/profile', auth.createAuthMiddleware(), getProfile);
```

<details>
<summary>‚úç –†–µ—à–µ–Ω–∏–µ</summary>

```javascript
const jwt = require('jsonwebtoken');
const bcrypt = require('bcrypt');
const crypto = require('crypto');

class AuthSystem {
    constructor(options = {}) {
        this.jwtSecret = options.jwtSecret || process.env.JWT_SECRET || 'your-secret-key';
        this.jwtExpiresIn = options.jwtExpiresIn || '24h';
        this.bcryptRounds = options.bcryptRounds || 12;
        this.maxLoginAttempts = options.maxLoginAttempts || 5;
        this.lockoutTime = options.lockoutTime || 15 * 60 * 1000; // 15 –º–∏–Ω—É—Ç
        
        // –•—Ä–∞–Ω–∏–ª–∏—â–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ë–î)
        this.users = new Map();
        this.loginAttempts = new Map();
        this.refreshTokens = new Map();
    }

    // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    async register(userData) {
        const { email, password, name } = userData;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if (this.users.has(email)) {
            throw new Error('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
        }
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
        if (!this.isValidEmail(email)) {
            throw new Error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email');
        }
        
        if (!this.isValidPassword(password)) {
            throw new Error('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤, –≤–∫–ª—é—á–∞—è –∑–∞–≥–ª–∞–≤–Ω—ã–µ –∏ —Å—Ç—Ä–æ—á–Ω—ã–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã');
        }
        
        // –•–µ—à–∏—Ä—É–µ–º –ø–∞—Ä–æ–ª—å
        const hashedPassword = await bcrypt.hash(password, this.bcryptRounds);
        
        // –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const user = {
            id: crypto.randomUUID(),
            email,
            password: hashedPassword,
            name,
            createdAt: new Date(),
            isActive: true
        };
        
        this.users.set(email, user);
        
        console.log(`‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${email} –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω`);
        
        return {
            success: true,
            message: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω',
            user: {
                id: user.id,
                email: user.email,
                name: user.name
            }
        };
    }

    // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    async login(email, password) {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫—É
        if (this.isAccountLocked(email)) {
            throw new Error('–ê–∫–∫–∞—É–Ω—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∏–∑-–∑–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞');
        }
        
        // –ù–∞—Ö–æ–¥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const user = this.users.get(email);
        if (!user) {
            this.recordFailedAttempt(email);
            throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å');
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–æ–ª—å
        const isPasswordValid = await bcrypt.compare(password, user.password);
        if (!isPasswordValid) {
            this.recordFailedAttempt(email);
            throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å');
        }
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
        this.loginAttempts.delete(email);
        
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–æ–∫–µ–Ω—ã
        const accessToken = this.generateAccessToken(user);
        const refreshToken = this.generateRefreshToken(user);
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º refresh token
        this.refreshTokens.set(refreshToken, {
            userId: user.id,
            email: user.email,
            createdAt: new Date()
        });
        
        console.log(`‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${email} –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω`);
        
        return {
            success: true,
            message: '–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞',
            tokens: {
                accessToken,
                refreshToken,
                expiresIn: this.jwtExpiresIn
            },
            user: {
                id: user.id,
                email: user.email,
                name: user.name
            }
        };
    }

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è access token
    generateAccessToken(user) {
        return jwt.sign(
            {
                userId: user.id,
                email: user.email,
                type: 'access'
            },
            this.jwtSecret,
            { expiresIn: this.jwtExpiresIn }
        );
    }

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è refresh token
    generateRefreshToken(user) {
        const token = crypto.randomBytes(64).toString('hex');
        return token;
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞
    verifyToken(token) {
        try {
            const decoded = jwt.verify(token, this.jwtSecret);
            
            if (decoded.type !== 'access') {
                throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–∏–ø —Ç–æ–∫–µ–Ω–∞');
            }
            
            return decoded;
        } catch (error) {
            throw new Error('–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω');
        }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
    async refreshAccessToken(refreshToken) {
        const tokenData = this.refreshTokens.get(refreshToken);
        
        if (!tokenData) {
            throw new Error('–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π refresh token');
        }
        
        const user = this.users.get(tokenData.email);
        if (!user || !user.isActive) {
            throw new Error('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω');
        }
        
        const newAccessToken = this.generateAccessToken(user);
        
        return {
            success: true,
            accessToken: newAccessToken,
            expiresIn: this.jwtExpiresIn
        };
    }

    // Middleware –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
    createAuthMiddleware() {
        return (req, res, next) => {
            try {
                const authHeader = req.headers.authorization;
                
                if (!authHeader || !authHeader.startsWith('Bearer ')) {
                    return res.status(401).json({
                        success: false,
                        message: '–¢–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω'
                    });
                }
                
                const token = authHeader.substring(7);
                const decoded = this.verifyToken(token);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –≤ –∑–∞–ø—Ä–æ—Å
                req.user = {
                    id: decoded.userId,
                    email: decoded.email
                };
                
                next();
            } catch (error) {
                return res.status(401).json({
                    success: false,
                    message: error.message
                });
            }
        };
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞
    isAccountLocked(email) {
        const attempts = this.loginAttempts.get(email);
        if (!attempts) return false;
        
        const now = Date.now();
        const timeSinceLastAttempt = now - attempts.lastAttempt;
        
        if (attempts.count >= this.maxLoginAttempts && timeSinceLastAttempt < this.lockoutTime) {
            return true;
        }
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –µ—Å–ª–∏ –ø—Ä–æ—à–ª–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Ä–µ–º–µ–Ω–∏
        if (timeSinceLastAttempt >= this.lockoutTime) {
            this.loginAttempts.delete(email);
            return false;
        }
        
        return false;
    }

    // –ó–∞–ø–∏—Å—å –Ω–µ—É–¥–∞—á–Ω–æ–π –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞
    recordFailedAttempt(email) {
        const attempts = this.loginAttempts.get(email) || { count: 0, lastAttempt: 0 };
        attempts.count++;
        attempts.lastAttempt = Date.now();
        this.loginAttempts.set(email, attempts);
        
        console.warn(`‚ö†Ô∏è  –ù–µ—É–¥–∞—á–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è ${email} (${attempts.count}/${this.maxLoginAttempts})`);
    }

    // –í–∞–ª–∏–¥–∞—Ü–∏—è email
    isValidEmail(email) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
    }

    // –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è
    isValidPassword(password) {
        const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d@$!%*?&]{8,}$/;
        return passwordRegex.test(password);
    }

    // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
    logout(refreshToken) {
        if (refreshToken) {
            this.refreshTokens.delete(refreshToken);
        }
        
        return {
            success: true,
            message: '–í—ã—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ'
        };
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    getStats() {
        return {
            totalUsers: this.users.size,
            activeRefreshTokens: this.refreshTokens.size,
            lockedAccounts: Array.from(this.loginAttempts.entries())
                .filter(([email, attempts]) => this.isAccountLocked(email)).length
        };
    }
}

// –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
const auth = new AuthSystem({
    jwtSecret: 'super-secret-key-change-in-production',
    jwtExpiresIn: '1h',
    maxLoginAttempts: 3,
    lockoutTime: 5 * 60 * 1000 // 5 –º–∏–Ω—É—Ç –¥–ª—è –¥–µ–º–æ
});

// Express –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
const express = require('express');
const app = express();

app.use(express.json());

// –ü—É–±–ª–∏—á–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
app.post('/register', async (req, res) => {
    try {
        const result = await auth.register(req.body);
        res.json(result);
    } catch (error) {
        res.status(400).json({
            success: false,
            message: error.message
        });
    }
});

app.post('/login', async (req, res) => {
    try {
        const { email, password } = req.body;
        const result = await auth.login(email, password);
        res.json(result);
    } catch (error) {
        res.status(401).json({
            success: false,
            message: error.message
        });
    }
});

app.post('/refresh', async (req, res) => {
    try {
        const { refreshToken } = req.body;
        const result = await auth.refreshAccessToken(refreshToken);
        res.json(result);
    } catch (error) {
        res.status(401).json({
            success: false,
            message: error.message
        });
    }
});

// –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
app.get('/profile', auth.createAuthMiddleware(), (req, res) => {
    res.json({
        success: true,
        message: '–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
        user: req.user
    });
});

app.post('/logout', auth.createAuthMiddleware(), (req, res) => {
    const { refreshToken } = req.body;
    const result = auth.logout(refreshToken);
    res.json(result);
});

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
app.get('/auth/stats', (req, res) => {
    res.json(auth.getStats());
});

module.exports = AuthSystem;
```

</details>

---

### üìå –ó–∞–¥–∞—á–∞ 3: –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

‚ùì –°–æ–∑–¥–∞–π—Ç–µ —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –∫–æ—Ç–æ—Ä–∞—è:
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –õ–æ–≥–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–∞—Ä—É—à–µ–Ω–∏—è—Ö
- –í–µ–¥–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∞—Ç–∞–∫

```javascript
// –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å SecurityMonitor:
// logEvent(type, details) - –ª–æ–≥–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
// detectAnomalies() - –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∞–Ω–æ–º–∞–ª–∏–∏
// generateReport() - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á–µ—Ç
// sendAlert(alert) - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
// const monitor = new SecurityMonitor();
// monitor.logEvent('failed_login', { ip: '192.168.1.1', user: 'admin' });
// monitor.startMonitoring();
```

<details>
<summary>‚úç –†–µ—à–µ–Ω–∏–µ</summary>

```javascript
class SecurityMonitor {
    constructor(options = {}) {
        this.events = [];
        this.maxEvents = options.maxEvents || 10000;
        this.alertThresholds = {
            failedLogins: 5,
            suspiciousRequests: 10,
            dataBreachAttempts: 3
        };
        this.alertCallbacks = [];
        this.isMonitoring = false;
        this.monitoringInterval = null;
    }

    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
    logEvent(type, details = {}) {
        const event = {
            id: this.generateEventId(),
            type,
            timestamp: new Date(),
            details,
            severity: this.getSeverity(type),
            ip: details.ip || 'unknown',
            userAgent: details.userAgent || 'unknown'
        };

        this.events.push(event);

        // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π
        if (this.events.length > this.maxEvents) {
            this.events.shift();
        }

        console.log(`üîç –°–æ–±—ã—Ç–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: ${type}`, details);

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –∞–Ω–æ–º–∞–ª–∏–∏
        this.checkForAnomalies(event);

        return event;
    }

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ID —Å–æ–±—ã—Ç–∏—è
    generateEventId() {
        return `evt_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    }

    // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏ —Å–æ–±—ã—Ç–∏—è
    getSeverity(type) {
        const severityMap = {
            'login_success': 'info',
            'login_failed': 'warning',
            'account_locked': 'warning',
            'suspicious_request': 'warning',
            'data_breach_attempt': 'critical',
            'rate_limit_exceeded': 'warning',
            'invalid_token': 'warning',
            'unauthorized_access': 'critical',
            'sql_injection_attempt': 'critical',
            'xss_attempt': 'critical'
        };

        return severityMap[type] || 'info';
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∞–Ω–æ–º–∞–ª–∏–∏
    checkForAnomalies(event) {
        const recentEvents = this.getRecentEvents(5 * 60 * 1000); // 5 –º–∏–Ω—É—Ç
        const ipEvents = recentEvents.filter(e => e.ip === event.ip);
        const userEvents = recentEvents.filter(e => e.details.user === event.details.user);

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞
        const failedLogins = ipEvents.filter(e => e.type === 'login_failed');
        if (failedLogins.length >= this.alertThresholds.failedLogins) {
            this.triggerAlert('multiple_failed_logins', {
                ip: event.ip,
                count: failedLogins.length,
                timeWindow: '5 minutes'
            });
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
        const suspiciousRequests = ipEvents.filter(e => e.type === 'suspicious_request');
        if (suspiciousRequests.length >= this.alertThresholds.suspiciousRequests) {
            this.triggerAlert('suspicious_activity', {
                ip: event.ip,
                count: suspiciousRequests.length,
                timeWindow: '5 minutes'
            });
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–ø—ã—Ç–∫–∏ –Ω–∞—Ä—É—à–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        const breachAttempts = ipEvents.filter(e => e.type === 'data_breach_attempt');
        if (breachAttempts.length >= this.alertThresholds.dataBreachAttempts) {
            this.triggerAlert('data_breach_attempts', {
                ip: event.ip,
                count: breachAttempts.length,
                timeWindow: '5 minutes'
            });
        }
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–µ–¥–∞–≤–Ω–∏—Ö —Å–æ–±—ã—Ç–∏–π
    getRecentEvents(timeWindow) {
        const cutoff = new Date(Date.now() - timeWindow);
        return this.events.filter(event => event.timestamp > cutoff);
    }

    // –°—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
    triggerAlert(type, details) {
        const alert = {
            id: this.generateEventId(),
            type,
            timestamp: new Date(),
            details,
            severity: 'high'
        };

        console.warn(`üö® –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò: ${type}`, details);

        // –í—ã–∑—ã–≤–∞–µ–º –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
        this.alertCallbacks.forEach(callback => {
            try {
                callback(alert);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:', error);
            }
        });
    }

    // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
    onAlert(callback) {
        this.alertCallbacks.push(callback);
    }

    // –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
    startMonitoring(interval = 60000) { // 1 –º–∏–Ω—É—Ç–∞
        if (this.isMonitoring) {
            console.log('‚ö†Ô∏è  –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É–∂–µ –∑–∞–ø—É—â–µ–Ω');
            return;
        }

        this.isMonitoring = true;
        console.log('üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∑–∞–ø—É—â–µ–Ω');

        this.monitoringInterval = setInterval(() => {
            this.performHealthCheck();
        }, interval);
    }

    // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
    stopMonitoring() {
        if (!this.isMonitoring) {
            console.log('‚ö†Ô∏è  –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–µ –∑–∞–ø—É—â–µ–Ω');
            return;
        }

        this.isMonitoring = false;
        if (this.monitoringInterval) {
            clearInterval(this.monitoringInterval);
            this.monitoringInterval = null;
        }

        console.log('‚èπÔ∏è  –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω');
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
    performHealthCheck() {
        const recentEvents = this.getRecentEvents(60 * 1000); // 1 –º–∏–Ω—É—Ç–∞
        const criticalEvents = recentEvents.filter(e => e.severity === 'critical');
        const warningEvents = recentEvents.filter(e => e.severity === 'warning');

        if (criticalEvents.length > 0) {
            console.warn(`‚ö†Ô∏è  –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ ${criticalEvents.length} –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–Ω—É—Ç—É`);
        }

        if (warningEvents.length > 10) {
            console.warn(`‚ö†Ô∏è  –í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: ${warningEvents.length} –∑–∞ –º–∏–Ω—É—Ç—É`);
        }
    }

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
    generateReport(timeRange = 24 * 60 * 60 * 1000) { // 24 —á–∞—Å–∞
        const cutoff = new Date(Date.now() - timeRange);
        const reportEvents = this.events.filter(event => event.timestamp > cutoff);

        const stats = {
            totalEvents: reportEvents.length,
            byType: {},
            bySeverity: {},
            byIP: {},
            timeRange: {
                start: cutoff,
                end: new Date()
            }
        };

        // –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–∏–ø–∞–º
        reportEvents.forEach(event => {
            stats.byType[event.type] = (stats.byType[event.type] || 0) + 1;
            stats.bySeverity[event.severity] = (stats.bySeverity[event.severity] || 0) + 1;
            stats.byIP[event.ip] = (stats.byIP[event.ip] || 0) + 1;
        });

        // –¢–æ–ø –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP
        const topSuspiciousIPs = Object.entries(stats.byIP)
            .sort(([,a], [,b]) => b - a)
            .slice(0, 10);

        return {
            ...stats,
            topSuspiciousIPs,
            recommendations: this.generateRecommendations(stats)
        };
    }

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
    generateRecommendations(stats) {
        const recommendations = [];

        if (stats.byType['login_failed'] > 100) {
            recommendations.push('–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —É—Å–∏–ª–µ–Ω–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å-–∞—Ç–∞–∫');
        }

        if (stats.byType['sql_injection_attempt'] > 0) {
            recommendations.push('–£—Å–∏–ª—å—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã');
        }

        if (stats.byType['xss_attempt'] > 0) {
            recommendations.push('–£–ª—É—á—à–∏—Ç–µ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—é HTML-–∫–æ–Ω—Ç–µ–Ω—Ç–∞');
        }

        if (stats.bySeverity['critical'] > 10) {
            recommendations.push('–ü—Ä–æ–≤–µ–¥–∏—Ç–µ –∞—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã');
        }

        return recommendations;
    }

    // –≠–∫—Å–ø–æ—Ä—Ç —Å–æ–±—ã—Ç–∏–π
    exportEvents(format = 'json') {
        if (format === 'json') {
            return JSON.stringify(this.events, null, 2);
        } else if (format === 'csv') {
            return this.eventsToCSV();
        }
        throw new Error('–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞');
    }

    // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ CSV
    eventsToCSV() {
        if (this.events.length === 0) return '';

        const headers = ['id', 'type', 'timestamp', 'severity', 'ip', 'userAgent'];
        const csvRows = [headers.join(',')];

        this.events.forEach(event => {
            const row = headers.map(header => {
                const value = event[header] || '';
                return `"${value.toString().replace(/"/g, '""')}"`;
            });
            csvRows.push(row.join(','));
        });

        return csvRows.join('\n');
    }

    // –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π
    cleanup(olderThan = 7 * 24 * 60 * 60 * 1000) { // 7 –¥–Ω–µ–π
        const cutoff = new Date(Date.now() - olderThan);
        const initialCount = this.events.length;
        
        this.events = this.events.filter(event => event.timestamp > cutoff);
        
        const removedCount = initialCount - this.events.length;
        console.log(`üßπ –û—á–∏—â–µ–Ω–æ ${removedCount} —Å—Ç–∞—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏`);
        
        return removedCount;
    }
}

// –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
const monitor = new SecurityMonitor();

// –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
monitor.onAlert((alert) => {
    console.log(`üìß –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: ${alert.type}`);
    // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É email, Slack, SMS –∏ —Ç.–¥.
});

// –ó–∞–ø—É—Å–∫–∞–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
monitor.startMonitoring(30000); // 30 —Å–µ–∫—É–Ω–¥

// –°–∏–º—É–ª–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏—è
setTimeout(() => {
    monitor.logEvent('login_failed', { ip: '192.168.1.100', user: 'admin' });
    monitor.logEvent('login_failed', { ip: '192.168.1.100', user: 'admin' });
    monitor.logEvent('login_failed', { ip: '192.168.1.100', user: 'admin' });
    monitor.logEvent('login_failed', { ip: '192.168.1.100', user: 'admin' });
    monitor.logEvent('login_failed', { ip: '192.168.1.100', user: 'admin' });
}, 2000);

setTimeout(() => {
    const report = monitor.generateReport();
    console.log('üìä –û—Ç—á–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:', report);
}, 5000);

module.exports = SecurityMonitor;
```

</details>

---

üéâ –≠—Ç–∏ –∑–∞–¥–∞—á–∏ –ø–æ–º–æ–≥—É—Ç –ø–æ–Ω—è—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø—ã –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ Node.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö –∏ –Ω–∞—É—á–∏—Ç—å—Å—è —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã.

---
