# Замыкания

Замыкание — это функция, которая "запоминает" свое лексическое окружение, даже когда выполняется вне него. Это позволяет функции иметь доступ к переменным из внешней функции после завершения ее выполнения.

---

## Что такое замыкание?

**Замыкание** в JavaScript — это функция, которая имеет доступ к:
1. Собственной области видимости.
2. Области видимости родительской функции.
3. Глобальной области видимости.

Даже после завершения выполнения родительской функции, замыкание "удерживает" доступ к этим переменным. Это делает замыкания удобным инструментом для сохранения состояния и работы с приватными переменными.

---

## Как работает замыкание?

Когда функция создается в JavaScript, она "запоминает" область видимости, в которой была объявлена. Эта область включает все переменные, определенные в функции и в ее родительских функциях. Замыкание продолжает "жить", даже если внешняя функция завершила выполнение.

#### Пример:
```javascript
function outerFunction() {
    let outerVariable = 'Я снаружи!';
    function innerFunction() {
        console.log(outerVariable); // Доступ к переменной outerVariable
    }
    return innerFunction;
}
const closure = outerFunction(); // outerFunction возвращает innerFunction
closure(); // 'Я снаружи!'
```

1. В `outerFunction` определяется переменная `outerVariable`.
2. Внутри нее объявлена функция `innerFunction`, которая использует `outerVariable`.
3. После вызова `outerFunction` она возвращает `innerFunction`.
4. Замыкание сохраняет доступ к `outerVariable`, даже после завершения `outerFunction`.

---

## Применение замыканий

### 1. **Создание приватных переменных**
Замыкания позволяют скрывать переменные от внешнего кода, предоставляя интерфейс для управления ими.

```javascript
function createCounter() {
    let count = 0; // Приватная переменная
    return {
        increment: function() {
            count++;
            return count;
        },
        decrement: function() {
            count--;
            return count;
        },
        getCount: function() {
            return count;
        }
    };
}
const counter = createCounter();
console.log(counter.increment()); // 1
console.log(counter.increment()); // 2
console.log(counter.getCount());  // 2
console.log(counter.decrement()); // 1
```

---

### 2. **Функции обратного вызова (Callback)**
Замыкания позволяют передавать состояние в функцию обратного вызова.

```javascript
function makeCounter() {
    let count = 0;
    return function() {
        count++;
        return count;
    };
}
const counter1 = makeCounter();
const counter2 = makeCounter();

console.log(counter1()); // 1
console.log(counter1()); // 2
console.log(counter2()); // 1
```

---

### 3. **Модули**
Замыкания используются для создания модулей, которые инкапсулируют внутренние данные.

```javascript
const myModule = (function() {
    let privateVar = 'Я приватный!';
    return {
        getPrivateVar: function() {
            return privateVar;
        }
    };
})();
console.log(myModule.getPrivateVar()); // 'Я приватный!'
// console.log(myModule.privateVar); // undefined
```

---

## Итог

**Замыкания** в JavaScript — это мощный инструмент для управления состоянием и инкапсуляции данных. Они позволяют создавать приватные переменные, сохранять данные между вызовами функций и использовать сложные конструкции, такие как модули или функции обратного вызова. Замыкания — это фундаментальная концепция, которая помогает решать широкий спектр задач в веб-разработке.

--- 
